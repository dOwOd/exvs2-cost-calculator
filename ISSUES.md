# EXVS2 コスト計算機 - 改善提案Issue一覧

このドキュメントは、ゲームユーザー、UIデザイナー、フロントエンドエンジニアの視点から洗い出した課題と改善案をまとめたものです。

---

## 🔴 高優先度（ユーザー価値が高い）

### Issue #1: 編成の保存・読み込み機能

**背景**
よく使う編成を毎回手動で選択し直す必要があり、ユーザー体験が悪い。実戦で複数の編成パターンを試す際に非効率。

**提案内容**
- LocalStorageを使った編成の保存機能
- 保存した編成の一覧表示・読み込み
- 編成に名前を付けて管理（例: "3000固定", "低コスト編成"）
- 最大10件程度の保存枠

**実装の考慮点**
- `localStorage`に`Formation[]`を保存
- 編成パネルに「保存」「読み込み」ボタンを追加
- 保存済み編成のドロップダウンまたはモーダル表示

**期待される効果**
- よく使う編成への素早いアクセス
- 複数編成の試行錯誤が容易に

---

### Issue #2: URLによる編成の共有機能

**背景**
チームメイトや友人と編成の計算結果を共有したいが、現状では手段がない。スクリーンショットを撮って送るしかない。

**提案内容**
- 編成とフィルター状態をURLクエリパラメータにエンコード
- URLをコピーボタンでクリップボードにコピー
- URLアクセス時に自動的に編成を復元
- 例: `?unitA=3000-800&unitB=2500-680&exOnly=true`

**実装の考慮点**
- `useEffect`でURLパラメータから編成を復元
- `URLSearchParams`でクエリ文字列を生成
- ブラウザの履歴管理（`history.pushState`）
- エラーハンドリング（不正なパラメータ）

**期待される効果**
- 編成の簡単な共有
- ブラウザバック/フォワードでの編成切り替え
- ブックマークによる編成の保存

---

### Issue #3: レスポンシブデザイン対応（スマートフォン）

**背景**
v1.0ではスコープ外だが、実際のゲームプレイヤーはアーケードの待ち時間や移動中にスマホで確認したいニーズが高い。現状はデスクトップのみ。

**提案内容**
- モバイルファーストのレスポンシブデザイン
- 編成選択と結果表示を縦並びに変更（768px以下）
- タッチ操作に最適化されたUI（ボタンサイズ、スワイプ対応）
- コスト推移テーブルのモバイル表示最適化（横スクロール、簡略表示）

**実装の考慮点**
- Tailwindのブレークポイント活用（`sm:`, `md:`, `lg:`）
- タッチイベントのハンドリング
- ビューポートメタタグの設定確認
- パフォーマンス最適化（モバイル回線を考慮）

**期待される効果**
- ゲームプレイヤーの主要な利用シーン（移動中、待ち時間）に対応
- ユーザーベースの大幅拡大

---

### Issue #4: パターンの折りたたみ・展開機能

**背景**
全パターンが常に展開されており、スクロール量が多く、上位パターンとの比較がしづらい。特にパターン数が多い編成（10パターン以上）で顕著。

**提案内容**
- デフォルトでTOP 3のみ展開、それ以外は折りたたみ
- 「すべて展開」「すべて折りたたみ」トグルボタン
- 個別パターンのクリックで展開/折りたたみ
- 折りたたみ時はランク・パターン・総耐久のサマリーのみ表示

**実装の考慮点**
- 各パターンに`isExpanded`状態を追加
- アニメーション（`transition-all`, `max-h-0` → `max-h-screen`）
- アコーディオン形式のアクセシビリティ対応（ARIA属性）

**期待される効果**
- スクロール量の削減
- 重要なパターン（上位ランク）への集中
- パターン比較の容易化

---

### Issue #5: 編成比較モード

**背景**
複数の編成を検討する際、一つずつ選択し直して結果を見る必要があり、比較が困難。「3000+2500 vs 2500+2500」のような比較ニーズが高い。

**提案内容**
- 比較モードの追加（通常モード/比較モード切り替え）
- 最大2-3個の編成を並べて表示
- 各編成のTOP 3パターンを横並びで比較
- 総耐久、EX発動可能パターン数などの比較指標

**実装の考慮点**
- 状態管理の複雑化（複数編成の管理）
- レイアウトの工夫（横スクロール、タブ切り替え）
- モバイル表示での最適化

**期待される効果**
- 編成選択の意思決定支援
- 複数編成の長所・短所の可視化

---

## 🟡 中優先度（使いやすさ向上）

### Issue #6: コスト推移のビジュアル化（グラフ表示）

**背景**
現在はテーブル表示のみで、コスト推移の全体像を俯瞰しにくい。視覚的にコストの減少やEX発動タイミングを把握したい。

**提案内容**
- コスト推移を折れ線グラフで表示
- X軸: 撃墜順、Y軸: 残コスト
- EX発動可能ラインを赤い点線で表示
- コストオーバーエリアを色分け
- テーブルとグラフの切り替え、または並列表示

**実装の考慮点**
- 軽量なグラフライブラリの選定（Chart.js, Recharts, etc.）
- SVGでの手動実装も検討（依存追加を避けるため）
- レスポンシブ対応

**期待される効果**
- コスト推移の直感的な理解
- EX発動タイミングの視覚的把握

---

### Issue #7: EX発動タイミングのハイライト表示

**背景**
EX発動可能になるタイミングがテーブル内で分かりにくい。コストバーの色変化だけでは見逃しやすい。

**提案内容**
- EX発動可能になった最初のステップを強調表示
- アイコン、バッジ、アニメーションなどで目立たせる
- 「このステップでEX発動可能になりました」という明示的な表示

**実装の考慮点**
- `transitions`配列から発動タイミングを検出
- CSSアニメーション（`animate-pulse`など）
- 色覚異常者への配慮（色だけに頼らない）

**期待される効果**
- 重要な情報の見逃し防止
- 初心者にも分かりやすいUI

---

### Issue #8: 最近使用した機体の履歴表示

**背景**
機体検索で毎回同じ機体を検索するのは手間。よく使う機体をすぐに選択したい。

**提案内容**
- 最近選択した機体をLocalStorageに保存（最大5-10件）
- 機体検索フィールドの下に「最近使用した機体」セクションを表示
- クリックで即座に選択

**実装の考慮点**
- `localStorage`に履歴を保存
- 重複排除と上限管理
- プライバシー配慮（LocalStorageのみ、サーバー送信なし）

**期待される効果**
- よく使う機体への素早いアクセス
- 操作回数の削減

---

### Issue #9: お気に入り機体の登録機能

**背景**
プレイヤーは特定の機体を使い続けることが多く、毎回検索するのは煩雑。

**提案内容**
- 機体をお気に入りに登録する機能
- お気に入り一覧の表示（機体選択パネル上部など）
- 星アイコンでトグル

**実装の考慮点**
- `localStorage`でお気に入り機体IDを管理
- お気に入り一覧のUI設計
- お気に入りの編集・削除機能

**期待される効果**
- よく使う機体への即座のアクセス
- ユーザー体験の向上

---

### Issue #10: 結果の画像エクスポート機能

**背景**
計算結果をSNSやDiscordで共有したいが、スクリーンショットを撮る必要がある。特定のパターンだけを切り取って共有したい。

**提案内容**
- パターンカードを画像（PNG）としてエクスポート
- 「画像としてダウンロード」ボタン
- OGP画像の動的生成（URL共有時のプレビュー）

**実装の考慮点**
- `html2canvas`ライブラリの使用
- Canvas APIでの手動描画（軽量化）
- サーバーサイドでのOGP画像生成（要検討）

**期待される効果**
- 計算結果の簡単な共有
- SNSでの拡散促進

---

### Issue #11: パターンの詳細ソート・フィルター機能

**背景**
現在は総耐久降順のみ。他の指標でソートしたい、複数条件でフィルターしたいニーズがある。

**提案内容**
- ソート軸の追加
  - コストオーバー回数昇順
  - EX発動タイミング早い順
  - 最短敗北耐久値降順
- 複合フィルター
  - コストオーバー回数の範囲指定
  - 特定の機体を先落ちさせるパターンのみ

**実装の考慮点**
- UIの複雑化を避ける（段階的導入）
- フィルター状態のURL反映
- パフォーマンス（大量パターンの再ソート）

**期待される効果**
- 多様なユーザーニーズへの対応
- 深い分析の実現

---

## 🔵 低優先度（長期的価値）

### Issue #12: 実戦サポート機能（現在状況からの逆算）

**背景**
実戦中に「現在残コスト3000、A機が2回落ちた状態。ここからの最適な立ち回りは？」を知りたいニーズがある。

**提案内容**
- 現在の状況入力フォーム
  - 残コスト
  - 各機体の撃墜回数
  - 現在の耐久状態
- 入力状態から最適な次の行動を提案
- EX発動可否の判定

**実装の考慮点**
- 新しい計算ロジックの追加
- 状態管理の拡張
- モバイル対応（実戦中の利用を考慮）

**期待される効果**
- 実戦での判断支援
- 初心者の学習支援
- アプリの価値向上

---

### Issue #13: バースト機能の追加

**背景**
v1.0スコープ外だが、ゲームの重要な要素。将来的に実装したい。

**提案内容**
- バーストの種類選択（覚醒、格闘、射撃）
- バースト持続時間とコスト効率の計算
- バーストタイミングの最適化提案

**実装の考慮点**
- ゲーム仕様の詳細調査
- 計算ロジックの大幅拡張
- UI設計（複雑化を避ける）

**期待される効果**
- より実戦に近いシミュレーション
- 上級者向け機能の提供

---

### Issue #14: アクセシビリティの向上

**背景**
現状のアクセシビリティ対応状況が不明。すべてのユーザーが利用できるべき。

**提案内容**
- キーボードナビゲーションの完全対応
- スクリーンリーダー対応（ARIA属性）
- カラーコントラスト比の改善（WCAG AA準拠）
- フォーカス表示の明確化
- 色覚異常者への配慮（色だけに頼らない情報設計）

**実装の考慮点**
- axe DevToolsなどでの検証
- `role`, `aria-label`などの適切な設定
- `tabindex`の適切な管理

**期待される効果**
- より多くのユーザーへのアクセス提供
- Web標準への準拠

---

### Issue #15: パフォーマンスの最適化

**背景**
パターン数が多い場合（16パターン全展開など）、レンダリングが重くなる可能性。

**提案内容**
- 仮想スクロール（react-window, react-virtualized）の導入
- メモ化の最適化（`useMemo`, `memo`）
- レンダリング最適化（不要な再レンダリング削減）
- 遅延ロード（パターンカードの段階的読み込み）

**実装の考慮点**
- パフォーマンス計測（React DevTools Profiler）
- 最適化の優先順位付け
- バンドルサイズの監視

**期待される効果**
- スムーズなユーザー体験
- モバイルでのパフォーマンス向上

---

### Issue #16: E2Eテストの導入

**背景**
現在はユニットテストのみ。UIの統合テストがなく、リグレッションのリスクがある。

**提案内容**
- PlaywrightまたはCypressの導入
- 主要なユーザーフローのテスト
  - 編成選択 → 結果表示
  - フィルター機能
  - 編成の保存・読み込み
- CI/CDでの自動実行

**実装の考慮点**
- テストフレームワークの選定
- テストの保守コスト
- CI環境の設定

**期待される効果**
- 品質の向上
- リグレッション防止
- 安心してリファクタリング可能

---

### Issue #17: Storybookの導入

**背景**
コンポーネントの開発とドキュメンテーションが不十分。再利用性が低い。

**提案内容**
- Storybookの導入
- 主要コンポーネントのストーリー作成
- ビジュアルリグレッションテスト（Chromatic）

**実装の考慮点**
- Astro + Preact環境でのStorybook設定
- ストーリー作成コスト
- CI/CDとの統合

**期待される効果**
- コンポーネントの再利用性向上
- 開発体験の向上
- ドキュメンテーションの自動化

---

### Issue #18: データの拡充とメンテナンス

**背景**
機体データが古い、または一部機体が未登録の可能性。定期的な更新が必要。

**提案内容**
- 全機体データの網羅性確認
- データ更新の仕組み化（JSONファイル、管理画面）
- ゲームアップデート時の追従プロセス

**実装の考慮点**
- データソースの信頼性
- データ更新の自動化
- バージョン管理

**期待される効果**
- 常に最新のゲーム情報を提供
- ユーザーの信頼性向上

---

### Issue #19: ダークモード/ライトモードの切り替え

**背景**
現在はダークモードのみ。ライトモード派のユーザーへの配慮がない。

**提案内容**
- ライトモードの追加
- システム設定の自動検出（`prefers-color-scheme`）
- 手動切り替えトグル
- 選択をLocalStorageに保存

**実装の考慮点**
- Tailwindのダークモード設定（`class`戦略）
- 全コンポーネントの色設計見直し
- アクセシビリティ（両モードでコントラスト確保）

**期待される効果**
- より多くのユーザーの好みに対応
- ブランディングの多様化

---

### Issue #20: オフライン対応（PWA化）

**背景**
アーケードゲームセンター内は電波が悪いことがある。オフラインでも使えると便利。

**提案内容**
- Service WorkerによるPWA化
- オフラインでの動作保証
- インストール可能なアプリ化
- キャッシュ戦略の最適化

**実装の考慮点**
- Astroのビルド設定
- Service Workerの登録
- キャッシュの更新戦略
- ブラウザ互換性

**期待される効果**
- オフラインでの利用可能性
- アプリライクな体験
- ホーム画面への追加

---

## 📊 優先順位サマリー

| 優先度 | Issue番号 | タイトル |
|:-----|:---------|:---------|
| 🔴 高 | #1 | 編成の保存・読み込み機能 |
| 🔴 高 | #2 | URLによる編成の共有機能 |
| 🔴 高 | #3 | レスポンシブデザイン対応（スマートフォン） |
| 🔴 高 | #4 | パターンの折りたたみ・展開機能 |
| 🔴 高 | #5 | 編成比較モード |
| 🟡 中 | #6 | コスト推移のビジュアル化（グラフ表示） |
| 🟡 中 | #7 | EX発動タイミングのハイライト表示 |
| 🟡 中 | #8 | 最近使用した機体の履歴表示 |
| 🟡 中 | #9 | お気に入り機体の登録機能 |
| 🟡 中 | #10 | 結果の画像エクスポート機能 |
| 🟡 中 | #11 | パターンの詳細ソート・フィルター機能 |
| 🔵 低 | #12 | 実戦サポート機能（現在状況からの逆算） |
| 🔵 低 | #13 | バースト機能の追加 |
| 🔵 低 | #14 | アクセシビリティの向上 |
| 🔵 低 | #15 | パフォーマンスの最適化 |
| 🔵 低 | #16 | E2Eテストの導入 |
| 🔵 低 | #17 | Storybookの導入 |
| 🔵 低 | #18 | データの拡充とメンテナンス |
| 🔵 低 | #19 | ダークモード/ライトモードの切り替え |
| 🔵 低 | #20 | オフライン対応（PWA化） |

---

## 次のステップ

1. **高優先度Issue**から順に取り組むことを推奨
2. 各Issueを個別のGitHub Issueとして登録
3. マイルストーン・ラベルで管理
4. ユーザーフィードバックを収集して優先順位を調整

---

このIssue一覧は、EXVS2コスト計算機をより実用的で使いやすいツールにするためのロードマップとして活用できます。
